# Отчет к лабораторной работе 4: Конфигурация IP-фабрики в ЦОД на основе протокола BGP

## Задание к лабораторной работе:

### 1 По аналогии с лабораторными работами 1 и 2 настроить маршрутизацию в ЦОД на основе протокола динамической маршрутизации BGP
### 2 Написать генератор конфигурации маршрутизации на Python
Генератор конфигурации реализован в файле: `src/tsk2/conf_generator.py`  
**Предварительные требования**:  
Необходимо, чтобы были произведены базовые настройки окружения. То есть все контейнеры топологии должны быть подняты и активны.  
**Инструкция**:  
Скрипт сам подключается к необходимым узлам топологии (контейнерам) и выполняет необходимые команды.   
При этом все исполняыемые команды записываются в соответствующие `.conf` файлы.  
Для каждого устройства – свой файл. В качестве примеры файлы так же приложены, находятся по пути:
`src/tsk2/artifacts/**`
### 3 Написать скрипт на Python, делающий парсинг вывода
Генератор конфигурации реализован в файле: `src/tsk3/parse_node_commands.py`.  
В файл `output.txt` записываются все исполняемые команды, а так же их результат.  
Пример файла находится по пути: `src/tsk3/artifacts/output.txt`

**Все используемые _Next Hop_ можно увидеть в выводе команды `sh ip bgp`**

Основываясь на выводе команды `sh ip bgp` для `PC1`, можем определить `AS PATH` между `PC1` и `PC2`:
```
AS PATH (Autonomous System Path) - это последовательность номеров автономных систем, через которые проходит маршрут в протоколе BGP (Border Gateway Protocol). 
Каждая автономная система (AS) имеет уникальный номер и представляет собой сеть или группу сетей, управляемых одним администратором. AS PATH указывает путь, который маршрут проходит от отправителя до получателя.

В предоставленном выводе команды `sh ip bgp` можно увидеть информацию о маршрутах в таблице BGP, включая AS PATH. 
Например, для маршрута к 10.0.254.8/32 AS PATH выглядит следующим образом: 65001 65000 65002 65101. 
Это означает, что маршрут проходит через автономные системы с номерами 65001, 65000, 65002 и 65101.

AS PATH позволяет определить путь, по которому проходит маршрут в сети Интернет, и может быть полезным для анализа и оптимизации маршрутизации.
```

Итого, `AS PATH` между `PC1` и `PC2` – `65001 65000 65002 65101`

Ниже для справки приведен непосредственный вывод команды `sh ip bgp`:
```
BGP table version is 18, local router ID is 10.0.254.7, vrf id 0
Default local pref 100, local AS 65100
Status codes:  s suppressed, d damped, h history, * valid, > best, = multipath,
               i internal, r RIB-failure, S Stale, R Removed
Nexthop codes: @NNN nexthop's vrf id, < announce-nh-self
Origin codes:  i - IGP, e - EGP, ? - incomplete
RPKI validation codes: V valid, I invalid, N Not found

   Network          Next Hop            Metric LocPrf Weight Path
*> 10.0.254.1/32    172.16.11.2                            0 65001 65000 ?
*> 10.0.254.2/32    172.16.11.2                            0 65001 65000 ?
*> 10.0.254.3/32    172.16.11.2                            0 65001 65200 ?
*> 10.0.254.4/32    172.16.11.2                            0 65001 65200 ?
*> 10.0.254.5/32    172.16.11.2              0             0 65001 ?
*> 10.0.254.6/32    172.16.11.2                            0 65001 65000 65002 ?
*> 10.0.254.7/32    0.0.0.0                  0         32768 ?
*> 10.0.254.8/32    172.16.11.2                            0 65001 65000 65002 65101 ?
*  172.16.11.0/30   172.16.11.2              0             0 65001 ?
*>                  0.0.0.0                  0         32768 ?
*> 172.16.22.0/30   172.16.11.2                            0 65001 65000 65002 ?
*> 172.16.111.0/30  172.16.11.2              0             0 65001 ?
*> 172.16.112.0/30  172.16.11.2              0             0 65001 ?
*> 172.16.113.0/30  172.16.11.2              0             0 65001 ?
*> 172.16.114.0/30  172.16.11.2              0             0 65001 ?
*> 172.16.221.0/30  172.16.11.2                            0 65001 65000 ?
*> 172.16.222.0/30  172.16.11.2                            0 65001 65000 ?
*> 172.16.223.0/30  172.16.11.2                            0 65001 65200 ?
*> 172.16.224.0/30  172.16.11.2                            0 65001 65200 ?

Displayed  18 routes and 19 total paths
```
